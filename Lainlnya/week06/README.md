# HTTPSμ™€ TLS

## 1οΈβƒ£ μ•”νΈν™”

μ•”νΈν™”λ” μΉμΈλ λ‹Ήμ‚¬μλ§ μ •λ³΄λ¥Ό μ΄ν•΄ν•  μ μλ„λ΅ λ°μ΄ν„°λ¥Ό `μ¤ν¬λ¨λΈ”` ν• λ°©λ²•

β‡’ λ³µνΈν™”ν•λ ¤λ©΄ μ†΅μ‹ μμ™€ μμ‹ μκ°€ μ„λ΅ λ™μν• `ν‚¤` κ°€ ν•„μ”ν•¨

\*\* μ¤ν¬λ¨λΈ” : κ° λ‹¨μ–΄λ‚ λ¬Έμλ¥Ό ν¨ν„΄μ— λ”°λΌ μ•”νΈν™” ν•λ” κ²ƒμ΄ μ•„λ‹λΌ λ¬΄μ‘μ„ λ°©μ‹μΌλ΅ κ°λ³„ λ°μ΄ν„° λΉ„νΈλ¥Ό μ„λ” κ²ƒ

### λ€μΉ­ μ•”νΈν™”

ν‚¤λ¥Ό ν•λ‚λ§ μ‚¬μ©ν•λ” μ•”νΈν™” λ°©λ²•

Plaintext + key = ciphertext (hello + 2jd8932kd8 = X5xJCSycg14)

Ciphertext + key = plaintext (X5xJCSycg14 = hello + 2jd8932kd8)

### λΉ„λ€μΉ­ μ•”νΈν™”

κ³µκ°ν‚¤ μ•”νΈν™”

λ‘ κ°μ λ‹¤λ¥Έ ν‚¤(κ³µκ°ν‚¤, κ°μΈν‚¤)λ΅ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•κ±°λ‚ μ„λ…ν•κ³ , ν‚¤ μ¤‘ ν•λ‚μΈ κ³µκ° ν‚¤λ¥Ό λ„κµ¬λ‚ μ‚¬μ©ν•  μ μλ„λ΅ ν•λ” λ°©λ²•

**κ³µκ°ν‚¤λ΅ μ•”νΈν™”λ λ°μ΄ν„°λ” κ°μΈν‚¤λ΅λ§ λ³µνΈν™” κ°€λ¥**

μ•κ³ λ¦¬μ¦ : RSA, DH

β”οΈ μΌλ°μ μΌλ΅ HTTPSλ¥Ό κ°€λ¥ν•κ² ν•λ” ν”„λ΅ν† μ½μΈ TLSλ” λ¶€λ¶„μ μΌλ΅ **λΉ„λ€μΉ­ μ•”νΈν™” μ‚¬μ©** , λΉ„λ€μΉ­μ•”νΈν™”λ΅ μΈμ¦ ν• ν›„, **λ€μΉ­ μ•”νΈν™”λ΅ λ³΄μ•μ  ν†µμ‹  μ‹μ‘**

β”οΈ TLS ν•Έλ“μ…°μ΄ν¬ κ³Όμ •μ—μ„ μ²μ μΈμ¦ν•  λ• λΉ„λ€μΉ­ μ•”νΈν™”λ¥Ό ν•κ³ , κ·Έ μ΄ν›„ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” `μ„Έμ…ν‚¤` λΌκ³  ν•λ” ν‚¤λ¥Ό κΈ°λ°μΌλ΅ λ€μ°½ μ•”νΈν™”λ¥Ό κΈ°λ°μΌλ΅ μ•”νΈν™”λ ν†µμ‹ μ„ ν•¨

### μ•”νΈν™”μ ν•„μ”μ„±

μλ„λ μμ‹ μ λλ” μ†΅μ‹ μλ¥Ό μ μ™Έν•κ³ λ” ν†µμ‹ μ„ ν•μ΄μ ν‚Ή(κ°€λ΅μ±„κΈ°)ν•μ—¬ μ½μ„ μ μ—†κ² ν•λ©°, μ΄λ¥Ό ν†µν•΄ λ―Όκ°ν• λ°μ΄ν„°μ μ μ¶μ„ λ°©μ§€ν•κ³  λ°μ΄ν„° λ¬΄κ²°μ„±μ„ λ³΄μ¥

## 2οΈβƒ£ TLS ν•Έλ“μ…°μ΄ν¬

### TLS

μ „μ†΅ κ³„μΈµμ—μ„ λ³΄μ•μ„ μ κ³µν•λ” ν”„λ΅ν† μ½

ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ ν†µμ‹ ν•  λ• TLSλ¥Ό ν†µν•΄ μ  3μκ°€ λ©”μ‹μ§€λ¥Ό λ„μ²­ν•κ±°λ‚ λ³€μ΅°ν•μ§€ λ»ν•λ„λ΅ ν•¨

### κ³Όμ •

ν• λ²μ RTT(λΉ„λ€μΉ­μ•”νΈν™”)λ¥Ό ν†µν•΄ μ•”νΈν™”λ ν†µμ‹ μ„ ν•λ” κ²ƒ, μ΄ν›„ λ€μΉ­ μ•”νΈν™”

![Untitled](./assets/TLS.png)

1. Client Hello

   ν΄λΌμ΄μ–ΈνΈλ” TLS λ²„μ „, μ‚¬μ΄νΌμνΈμ™€ ν΄λΌμ΄μ–ΈνΈ λλ¤κ°’(λ¬΄μ‘μ„ λ¬Έμμ—΄), μ„μ‹ DH λ§¤κ°λ³€μλ¥Ό μ„λ²„μ—κ² λ³΄λƒ„

2. Server Hello, EncryptedExtensions, Certificate, CertificateVerify

   μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° λ°›μ€ μµμ…μ„ ν™•μΈ

   μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ λ¨λ‘μ—μ„ μ§€μ›ν•λ” **κ°€μ¥ λ†’μ€ TLS λ²„μ „μ„ μ‹λ³„**ν•μ—¬ κ²°μ •, **μ‚¬μ΄νΌμνΈ μ§€μ› μ—¬λ¶€λ¥Ό ν™•μΈ**

   κ³µκ°ν‚¤κ°€ ν¬ν•¨λ SSL μΈμ¦μ„, μ„λ²„ λλ¤κ°’, μ„μ‹ DH λ§¤κ°λ³€μλ¥Ό λ³΄λƒ„

   ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°κ° μ„λ΅ κµν™ν• DH λ§¤κ°λ³€μλ¥Ό μ‚¬μ©ν•μ—¬ μ„μ‹ μ•”νΈ ν‚¤(μ„Έμ…ν‚¤)λ¥Ό μƒμ„±

3. Finished

   ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” μ„Έμ…ν‚¤λ¥Ό κΈ°λ°μΌλ΅ **λ€μΉ­ μ•”νΈν™”λ ν†µμ‹ μ΄ μ‹μ‘** = λ³΄μ• μ„Έμ…μ μ‹μ‘

   ν‚¤κµν™ μ•κ³ λ¦¬μ¦μ€ λ€ν‘μ μΌλ΅ RSAμ™€ DH

   RSAλ” μ·¨μ•½μ μ΄ μκΈ° λ•λ¬Έμ— ν„μ¬ λ²„μ „μ—μ„λ” μ§€μ›ν•μ§€ μ•μ, DHλ” νƒ€μ›κ³΅μ„  DH μ‚¬μ©

### DH λ§¤κ°λ³€μ

DH = Diffie-Hellman β‡’ μ„λ΅ κ³µκ°κ°’ κ³µμ , λΉ„λ°€κ°’κ³Ό νΌν•©, νΌν•©κ°’κ³Ό κ³µμ , κ°μμ λΉ„λ°€κ°’κ³Ό νΌν•©ν•΄μ„ κ³µν†µμ μ•”νΈν‚¤λ¥Ό λ§λ“λ” μ•κ³ λ¦¬μ¦

\*\* λ””ν”Όν—¬λ§μ„ μ‚¬μ©ν•λ” DHEμ™€, νƒ€μ›κ³΅μ„  μ•”νΈν™” λ°©λ²•κ³Ό DHλ¥Ό μ„μ€ ECDHEκ°€ μλ”λ° ECDHEλ¥Ό μ‚¬μ©!

![Untitled](./assets/DH.png)

![Untitled](./assets/rotate.png)

β‡’ κ³µκ°κ°’ κ³µμ μ™€ νΌν•©κ°’ κ³µμ λ” ν• λ²μ— μΌμ–΄λ‚  μ μκΈ° λ•λ¬Έμ— 1RTTλ§μ— κ°€λ¥

νƒ€μ›κ³΅μ„  μ•”νΈν™” λ°©λ²•: κ³΅μ„ μ„ μ‚¬μ©ν•μ—¬ **κ°μΈ ν‚¤ λ³΄μ μλ§ μ• μ μλ” νƒ€μ› κ³΅μ„ μ„ κ·Έλ¦¬λ©°, μ΄λ¥Ό κΈ°λ°μΌλ΅ κµμ°¨μ μ„ μƒμ„±**. μ΄ κµμ°¨μ μ μλ¥Ό κΈ°λ°μΌλ΅ μ•”νΈλ¥Ό μ„¤μ •ν•λ” λ°©λ²•

## μ‚¬μ΄νΌμνΈ

ν”„λ΅ν† μ½, AEAD μ‚¬μ΄νΌ λ¨λ“, ν•΄μ‹± μ•κ³ λ¦¬μ¦μ΄ λ‚μ—΄λ κµ¬μ•½μ„ μλ―Έν•λ©° μ•”νΈμ ν’κµ°μ΄λΌκ³  λ¶λ¦Ό β‡’ μ·¨μ•½μ μ΄ λ¨λ‘ μ κ±°λ μ•”νΈμ ν’κµ°

<aside>
    
    π’΅ TLS_AES_128_GCM_SHA256

    TLS: ν”„λ΅ν† μ½
    AES_128_GCM: AEAD μ‚¬μ΄νΌ λ¨λ“
    SHA256: ν•΄μ‹± μ•κ³ λ¦¬μ¦

</aside>

### AEAD μ‚¬μ΄νΌ λ¨λ“

AEAD(Authenicated Encryption with Associated Data): λ°μ΄ν„° μ•”νΈν™” μ•κ³ λ¦¬μ¦

μ) AES_128_GCM: 128λΉ„νΈμ ν‚¤λ¥Ό μ‚¬μ©ν•λ” ν‘μ¤€ λΈ”λ΅ μ•”νΈν™” κΈ°μ κ³Ό λ³‘λ ¬ κ³„μ‚°μ— μ©μ΄ν• μ•”νΈν™” μ•κ³ λ¦¬μ¦ GCMμ΄ κ²°ν•©λ μ•κ³ λ¦¬μ¦

### ν•΄μ‹± μ•κ³ λ¦¬μ¦

λ°μ΄ν„°λ¥Ό μ¶”μ •ν•κΈ° νλ“  λ” μ‘κ³ , μ„μ—¬ μλ” μ΅°κ°μΌλ΅ λ§λ“λ” μ•κ³ λ¦¬μ¦

SHA-256 μ•κ³ λ¦¬μ¦: **ν•΄μ‹ ν•¨μμ κ²°κ³Όκ°’μ΄ 256λΉ„νΈμΈ μ•κ³ λ¦¬μ¦**μ΄λ©° λΉ„νΈ μ½”μΈμ„ λΉ„λ΅―ν• λ§μ€ λΈ”λ΅μ²΄μΈ μ‹μ¤ν…μ—μ„ μ‚¬μ©

β”οΈΒ ν•΄μ‹± μ•κ³ λ¦¬μ¦μ΄ TLSμ—μ„ μ–΄λ–»κ² μ“°μ΄λ”μ§€ ?

μΈμ¦μ„κ°€ μ¬λ°”λ¥Έ μΈμ¦μ„μΈμ§€ ν™•μΈν•  λ• μ „μμ„λ…μ„ μ΄μ©ν•λ”λ°, μ΄ λ• ν•΄μ‹± μ•κ³ λ¦¬μ¦μ΄ μƒμ©λ¨

1. μΈμ¦ μƒμ„±μ‘μ—…: μ „μ μ„λ…μ„ λ§λ“λ”λ° μ„λ…λλ” λ©”μ‹μ§€λ¥Ό ν•΄μ‹±
2. μΈμ¦ ν™•μΈμ‘μ—…: λ©”μ‹μ§€λ¥Ό λ³µνΈν™”ν•΄μ„ ν•΄μ‹λ¥Ό μ„λ΅ λΉ„κµν•΄ μ¬λ°”λ¥Έ λ©”μ‹μ§€μΈμ§€ ν™•μΈ

β‡’ μ ν¨μ„± κ²€μ¦μ— μ‚¬μ©λ¨ (μ ν¨μ„± κ²€μ¦: μΈμ¦μ„κ°€ λ³€μ΅°λμ§€ μ•μ•κ³ , μΈμ¦μ„κ°€ β€μ„λΉ„μ¤μ κ³µμβ€™ κ²ƒμ„μ„ ν™•μΈν•λ” μ μ°¨)

## μΈμ¦μ„

1. μ£Όμ²΄(μΈμ¦μ„ λ°κΈ‰ν• CA, λ„λ©”μΈ, μ›Ήμ‚¬μ΄νΈ μ†μ μ, μΈμ¦μ„ μ†μ μ)
2. κ³µκ°ν‚¤(κ³µκ°ν‚¤, κ³µκ°ν‚¤ μ•”νΈν™”λ°©λ²•)

   β‡’ μ„μ λ‘ κ°€μ§€λ¥Ό ν¬ν•¨ν•λ” λ‹¨μν• λ°μ΄ν„° νμΌ

   β‡’ μμ‹ μ μ›Ήμ‚¬μ΄νΈ μ•μ—μ„ SSL μΈμ¦μ„λ¥Ό λ§λ“¤ μλ„ μμ§€λ§ λ³΄ν†µμ€ μΈμ¦κΈ°κ΄€μΈ CAμ—μ„ λ°κΈ‰ν• SSL μΈμ¦μ„λ¥Ό κΈ°λ°μΌλ΅ μΈμ¦ μ‘μ—…μ„ μν–‰

β”οΈΒ μ£Όμ²΄λ” ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν• μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈκ°€ μλ„ν• μ„λ²„κ°€ λ§λ”μ§€ ν™•μΈν•  λ• μ‚¬μ©

β”οΈΒ κ³µκ°ν‚¤λ” μ²μ μΈμ¦ μ‘μ—…μ„ μν–‰ν•  λ• μ“°μ„

## CA

μΈμ¦μ„κ°€ ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν• μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈκ°€ μλ„ν• μ„λ²„κ°€ λ§λ”μ§€λ¥Ό λ³΄μ¥ν•λ” μ—­ν•­μ„ ν•λ”λ°, μ΄ **μΈμ¦μ„λ¥Ό λ°κΈ‰ν•λ” κΈ°μ—…λ“¤μ„ CA**λΌκ³  ν•¨

- λ‹¨μΌ λ„λ©”μΈ: λ‹¨ ν•λ‚μ λ„λ©”μΈμ— μ μ©λλ” μΈμ¦μ„
- μ™€μΌλ“ μΉ΄λ“: λ„λ©”μΈμ ν•μ„ λ„λ©”μΈλ„ ν¬ν•¨ν•λ” μΈμ¦μ„.
- λ©€ν‹° λ„λ©”μΈ: μ΄λ¦„ μ΄ μλ―Έν•λ” κ²ƒμ²λΌ λ©€ν‹° λ„λ©”μΈ SSLμΈμ¦μ„λ” κ΄€λ ¨λμ§€ μ•μ€ λ‹¤μμ λ„λ©”μΈμ— μ μ©λ  μ μλ” μΈμ¦μ„

## RSAμ μ·¨μ•½μ 

RSAμ κ²½μ° **ν΄λΌμ΄μ–ΈνΈκ°€ μƒμ„±**ν• μ„μ‹ μ•”νΈκ°’μ„ μ„λ²„λ΅ μ „μ†΅ν•μ§€λ§, DHμ κ²½μ° **ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ μ„λ΅ κµν™ν• DH λ§¤κ°λ³€μ**λ¥Ό μ‚¬μ©ν•΄ κ°μΈν‚¤λ¥Ό λ§λ“¦

β‡’ RSAλ” ν΄λΌμ΄μ–ΈνΈμ—μ„ μƒμ„±ν• μ„μ‹ μ•”νΈκ°’μ΄ νƒμ·¨λ‹Ήν• κ²½μ° ν•΄ν‚Ήμ μ„ν—μ΄ μμ

β‡’ DHμ κ²½μ° νƒμ·¨λ‹Ήν•΄λ„ κ³µν†µμ μ•”νΈν‚¤λ¥Ό λ§λ“¤ μ μ—†μ

![Untitled](./assets/RSA.png)

## 0-RTT

μ„Έμ…ν‚¤κ°€ μƒμ„±λ μ΄ν›„ λ‹¤μ‹ κ·Έ μ‚¬μ΄νΈμ— λ°©λ¬Έν•λ‹¤λ©΄ λ―Έλ¦¬ λ§λ“¤μ–΄ λ†“μ€ μ„Έμ…ν‚¤λ¥Ό κΈ°λ°μΌλ΅ μ—°κ²°μ„ μƒμ„±ν•κΈ° λ•λ¬Έμ— μ΄ λ• μΈμ¦μ— λ“λ” λΉ„μ©μ€ μ—†μ

β‡’ μΈμ¦μ— κ΄€ν• RTTκ°€ λ°μƒλμ§€ μ•κΈ° λ•λ¬Έμ— 0-RTTλΌλ” νΉμ„±μ„ κ°–μ

β”οΈΒ λ„¤νΈμ›ν¬ μƒ λ³΄μ•μ„ ν•΄μ•Όν•λ” μ΄μ  ?\
λ―Όκ°ν• κΈμµ μ •λ³΄λ¥Ό λ‹¤λ£¨λ”λ° μ΄μ μ΄ μκ³ , HTTP/2λ¥Ό κµ¬ν„ν•  μ μκΈ° λ•λ¬Έ
